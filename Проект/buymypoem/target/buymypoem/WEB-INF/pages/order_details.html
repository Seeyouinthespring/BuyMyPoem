<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link th:href="@{/css/output_composition.css}" rel="stylesheet">
    <title>Заказ</title>
    <style>
        .choice_buttons{
            display: flex;
            flex-flow: row;
            justify-content: space-between;
        }
    </style>
</head>
<body class="main">
<div class="top">
    <div class="label">
        BuyMyPoem
    </div>
</div>

<div>
    <div th:if="${order.status=='CanceledByAuthor' and me.role=='Author'}">
        <h2>Вы отправили запрос на отмену заказа, ожидайте ответа Заказчика</h2>
    </div>
    <div th:if="${order.status=='CanceledByCustomer' and me.role=='Customer'}">
        <h2>Вы отправили запрос на отмену заказа, ожидайте ответа Автора</h2>
    </div>
    <div th:if="${order.status=='CanceledByAuthor' and me.role=='Customer'}">
        <h2>ВНИМАНИЕ! Исполнитель отправил запрос на отмену заказа. Обдумайте решение и дайте свой ответ</h2>
        <form action="#" th:action="@{/canceling/{id} (id=${order.orderID})}" method="post">
            <button>Отменить заказ</button>
        </form>
        <form action="#" th:action="@{/refuse_canceling/{id} (id=${order.orderID})}" method="post">
            <button>Отказаться от отмены заказа</button>
        </form>
    </div>
    <div th:if="${order.status=='CanceledByCustomer' and me.role=='Author'}">
        <h2>ВНИМАНИЕ! Заказчик отправил запрос на отмену заказа. Обдумайте решение и дайте свой ответ</h2>
        <form action="#" th:action="@{/canceling/{id} (id=${order.orderID})}" method="post">
            <button>Отменить заказ</button>
        </form>
        <form action="#" th:action="@{/refuse_canceling/{id} (id=${order.orderID})}" method="post">
            <button>Отказаться от отмены заказа</button>
        </form>
    </div>
</div>
<div class="basic">
    <div class="left">
        <div class="left-top">
            <div class="div_info_order">
                <div class="auth_cust">
                    <div>Заказчик:</div>
                    <div>
                        <img height="30px"  width="30px" th:src="@{'data:image/png;base64,' + ${order.customer.photo} }" />
                    </div>
                    <div>
                        <span th:text="${order.customer.login}"></span>
                    </div>
                </div>
                <div class="auth_cust">
                    <div>Исполнитель:</div>
                    <div>
                        <img height="30px"  width="30px" th:src="@{'data:image/png;base64,' + ${order.author.photo} }" />
                    </div>
                    <div>
                        <span th:text="${order.author.login}"></span>
                    </div>
                </div>
                <div class="description">
                    <div class="text">Дата публикации: <span th:text="${order.startdate}"></span></div>
                    <div class="text">Выполнить до: <span th:text="${order.deadline}"></span></div>
                    <div class="text">Стоимость: <span th:text="${order.cost}"></span></div>
                    <div class="text">Тип произведения: <span th:text="${order.type.title}"></span></div>
                    <div class="text">Жанр:  <span th:text="${order.genre.title}"></span></div>
                    <div class="text">Описание:  <span th:text="${order.description}"></span></div>
                    <div class="text">
                        <span th:if="${order.status=='Processing'}">&#9997;</span>
                        <span th:if="${order.status=='Ready'}">&#x2714;</span>
                        <span th:unless="${order.status=='Ready' or order.status=='Processing'}">&#10060;</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="left-bottom">
            <div class="table_comments">
                <table class="for_width">
                    <tr th:each="comment : ${comments}">
                        <td>
                            <div class="comment">
                                <div class="for_img">
                                    <img height="60px"  width="60px" th:src="@{'data:image/png;base64,' + ${comment.user.photo} }" />
                                </div>
                                <div class="not_photo">
                                    <div class="login_date">
                                        <span th:text="${comment.user.login}"></span>
                                        <span th:text="${comment.sendingDate}"></span>
                                    </div>
                                    <div class="comment_text">
                                        <span th:text="${comment.text}"></span>
                                    </div>
                                </div>
                            </div>
                        </td>
                    </tr>
                </table>
                <div>
                    <form action="#" th:action="@{/add_comment_order/{id} (id=${order.orderID})}" method="post">
                        <div class="comment">
                            <div class="not_photo">
                                <div class="login_date">
                                    <span th:text="${me.login}"></span>
                                </div>
                                <div class="comment_text">
                                    <input class="input_comment" type="text" name="Title" required="required" placeholder="Оставьте комментарий" th:field="${mycomment.text}" />
                                    <button class="last_btn">&#x2714;</button>
                                </div>
                             </div>
                       </div>
                    </form>
                </div>
           </div>
        </div>
    </div>

<div class="right">
    <div class="right-top">
        <div th:if="${me.role=='Author'and order.status=='Processing'}">
            <form action="#" th:action="@{/add_composition_to_order/{id} (id=${order.orderID})}" method="post">
                <div class="div_dynamyc_label">Добавьте произведение:</div>
                <div class="div_dynamyc">
                    <select class="input_text" th:field="*{comp.compositionID}">
                        <option th:each="draft : ${drafts}" th:value="${draft.compositionID}" th:text="${draft.title+' - '+draft.description+'('+draft.type.title+'/'+draft.genre.title+')'}">Жанр
                        </option>
                    </select>
                </div>
                <div>
                    <button class="button_comment2"> Отправить произведение</button>
                </div>
            </form>
        </div>
        <div>
            <textarea readonly class="text" placeholder="Текст заказа" th:field="${order.composition.text}">Текст произведения</textarea>
        </div>
    </div>
    <div class="choice_buttons" th:if="${me.role=='Customer' and order.status=='Ready'}">
        <div>
            <a th:href="@{/accept_order_form/{id} (id=${order.orderID})}" >Принять заказ</a>
        </div>
        <div>
            <a th:href="@{/send_order_form/{id} (id=${order.orderID})}" >Отправить на редактирование</a>
        </div>
    </div>
</div>
</div>
<div th:if="${order.status=='Processing'}">
    <form action="#" th:action="@{/cancel_order_ask/{id} (id=${order.orderID})}" method="post">
        <button>Запросить отмену заказа</button>
    </form>
</div>
</body>
</html>